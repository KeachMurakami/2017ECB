Reduce(Join_by, list(Irad, Eps, Optics)) %>%
filter(between(wavelength, 400, 800)) %>%
select(-k)
DataSet <-
Reduce(Join_by, list(Irad, Eps, Optics)) %>%
filter(between(wavelength, 400, 800)) %>%
select(-k)
DataSet <-
Reduce(Join_by, list(Irad, Eps, Optics)) %>%
filter(between(wavelength, 400, 800)) %>%
select(-k)
readline("LCHII? C2S2M2? (L/C)") %>%
switch(., L = "LHCIItrimer", C = "C2S2M2") %>%
L
readline("LCHII? C2S2M2? (L/C)") %>%
switch(., L = "LHCIItrimer", C = "C2S2M2")
readline("LCHII? C2S2M2? (L/C)") %>%
switch(., L = "LHCIItrimer", C = "C2S2M2") %>%
rename_(DataSet, PSII = .)
# Which should be used as 'PSII' (LHCIItrimer? or C2S2M2 complex?)
DataSet <-
readline("LCHII? C2S2M2? (L/C)") %>%
switch(., L = "LHCIItrimer", C = "C2S2M2") %>%
rename_(DataSet, PSII = .)
RatioSim <- seq(0, 2, length.out = 30)
mixture <- seq(0, 20, length.out = 5)
statetrans <- 0
data_path %>%
rename(PSII_PSI = ratio) %>%
ggplot(aes(x = wavelength, y = PathLength, col = PSII_PSI, group = PSII_PSI)) +
geom_line() +
coord_cartesian(xlim = c(350, 800)) +
scale_y_log10() +
xlab("wavelength [nm]") + ylab("path length [a.u.]") +
scale_color_gradient(high = "darkgreen", low = "orange")
ddd <-
lapply(mixture, function(mixture){
data_path <-
lapply(RatioSim, function(x){
DataSet %>%
# mutate(PSII = PSI + PSII * mixture / 100,
#        PSII = PSII - PSII * mixture / 100) %>%
mutate(t = log((1 - ref) / (trans)),
ratio = x,
sumA = (PSI + ratio * PSII), # PSIの量を１として相対化。残差はPathLengthにくりこみ
PathLength = t / sumA)
}) %>%
rbind_all2
lapply(RatioSim, function(x){
data_path %>%
filter(ratio == x) %>%
filter(between(wavelength, 600, 750)) %>%
transmute(A2 = 1 - ref - (1 - ref) / exp(ratio * PSII * PathLength),
A1 = 1 - ref - (1 - ref) / exp(PSI * PathLength),
# transmute(A2 = 1 - 1 / exp(ratio * PSII * PathLength),
#           A1 = 1 - 1 / exp(PSI * PathLength),
A2R = A2 * R, A1R = A1 * R, A2FR = A2 * FR, A1FR = A1 * FR) %>%
colwise(sum2)() %>%
mutate(Ratio = x)
}) %>%
rbind_all2 %>%
mutate(mixture = mixture / 100,
st = statetrans,
#             A2toA1_R = st * (A2R - A1R), A2toA1_FR = st * (A2FR - A1FR),
A2toA1_R = st * A2R, A2toA1_FR = st * A2FR,
RtoPS2 = (A2R - A2toA1_R) / (A2R + A1R), FRtoPS2 = (A2FR - A2toA1_FR) / (A2FR + A1FR))
})
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>%
ggplot(aes(x = RtoPS2, y = FRtoPS2)) +
theme_bw() +
geom_rect(aes(xmin = 0.544, xmax = 0.556, ymin = 0, ymax = 0.41), fill = "pink", alpha = 0.3) +
geom_rect(aes(xmin = 0, xmax = 0.61, ymin = 0.181, ymax = 0.199), fill = "grey90", alpha = 0.3) +
#  geom_line(aes(col = st, group = st)) +
geom_line(col = "grey") +
geom_point(aes(col = s)) +
scale_color_gradient(high = "darkgreen", low = "orange") +
gg_xy(c(0, .61, 0, .41))
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>%
ggplot(aes(x = RtoPS2, y = FRtoPS2)) +
theme_bw() +
geom_rect(aes(xmin = 0.544, xmax = 0.556, ymin = 0, ymax = 0.41), fill = "pink", alpha = 0.3) +
geom_rect(aes(xmin = 0, xmax = 0.61, ymin = 0.181, ymax = 0.199), fill = "grey90", alpha = 0.3) +
#  geom_line(aes(col = st, group = st)) +
geom_line(col = "grey") +
geom_point(aes(col = s)) +
scale_color_gradient(high = "darkgreen", low = "orange") +
gg_xy(c(0.39, .61, .09, .41))
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>%
ggplot(aes(x = RtoPS2, y = FRtoPS2)) +
theme_bw() +
geom_rect(aes(xmin = 0.544, xmax = 0.556, ymin = 0, ymax = 0.41), fill = "pink", alpha = 0.3) +
geom_rect(aes(xmin = 0, xmax = 0.61, ymin = 0.181, ymax = 0.199), fill = "grey90", alpha = 0.3) +
#  geom_line(aes(col = st, group = st)) +
geom_line(col = "grey") +
geom_point(aes(col = s)) +
scale_color_gradient(high = "darkgreen", low = "orange") +
gg_xy(c(0, .61, 0, .41))
ddd %>%
rbind_all2 %>%
mutate(s = Ratio)
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>% head
rep(c("W", "WFR"), 16)
rep(c("+", "-"), each = 8)
data.frame(RtoPS2 = c(.55, .56, .57, .57, .50, .51, .51, .52, .60, .61, .62, .62, .54, .55, .55, .56),
RtoPS2 = c(.18, .22, .24, .30, .16, .20, .22, .27, .23, .27, .29, .34, .20, .24, .26, .31),
Trtm = rep(c("W", "WFR"), 8),
CEF = rep(c("+", "-"), each = 8)
)
data.frame(RtoPS2 = c(.55, .56, .57, .57, .50, .51, .51, .52, .60, .61, .62, .62, .54, .55, .55, .56),
RtoPS2 = c(.18, .22, .24, .30, .16, .20, .22, .27, .23, .27, .29, .34, .20, .24, .26, .31),
Trtm = rep(c("W", "WFR"), 8),
CEF = rep(c("+", "-"), each = 8),
Residual = rep(c("+", "-", "+", "-"), each = 4))
points_meas <-
data.frame(RtoPS2 = c(.55, .56, .57, .57, .50, .51, .51, .52, .60, .61, .62, .62, .54, .55, .55, .56),
RtoPS2 = c(.18, .22, .24, .30, .16, .20, .22, .27, .23, .27, .29, .34, .20, .24, .26, .31),
Trtm = rep(c("W", "WFR"), 8),
CEF = rep(c("+", "-"), each = 8),
Residual = rep(c("+", "-", "+", "-"), each = 4))
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>%
ggplot(aes(x = RtoPS2, y = FRtoPS2)) +
theme_bw() +
geom_rect(aes(xmin = 0.544, xmax = 0.556, ymin = 0, ymax = 0.41), fill = "pink", alpha = 0.3) +
geom_rect(aes(xmin = 0, xmax = 0.61, ymin = 0.181, ymax = 0.199), fill = "grey90", alpha = 0.3) +
#  geom_line(aes(col = st, group = st)) +
geom_line(col = "grey") +
geom_point(aes(col = s)) +
scale_color_gradient(high = "darkgreen", low = "orange") +
gg_xy(c(0, .61, 0, .41)) + geom_point(data = points_meas, aes(RtoPS2, FRtoPS2, col = CEF)
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>%
ggplot(aes(x = RtoPS2, y = FRtoPS2)) +
theme_bw() +
geom_rect(aes(xmin = 0.544, xmax = 0.556, ymin = 0, ymax = 0.41), fill = "pink", alpha = 0.3) +
geom_rect(aes(xmin = 0, xmax = 0.61, ymin = 0.181, ymax = 0.199), fill = "grey90", alpha = 0.3) +
#  geom_line(aes(col = st, group = st)) +
geom_line(col = "grey") +
geom_point(aes(col = s)) +
scale_color_gradient(high = "darkgreen", low = "orange") +
gg_xy(c(0, .61, 0, .41)) + geom_point(data = points_meas, aes(RtoPS2, FRtoPS2, col = CEF))
points_meas <-
data.frame(RtoPS2 = c(.55, .56, .57, .57, .50, .51, .51, .52, .60, .61, .62, .62, .54, .55, .55, .56),
FRtoPS2 = c(.18, .22, .24, .30, .16, .20, .22, .27, .23, .27, .29, .34, .20, .24, .26, .31),
Trtm = rep(c("W", "WFR"), 8),
CEF = rep(c("+", "-"), each = 8),
Residual = rep(c("+", "-", "+", "-"), each = 4))
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>%
ggplot(aes(x = RtoPS2, y = FRtoPS2)) +
theme_bw() +
geom_rect(aes(xmin = 0.544, xmax = 0.556, ymin = 0, ymax = 0.41), fill = "pink", alpha = 0.3) +
geom_rect(aes(xmin = 0, xmax = 0.61, ymin = 0.181, ymax = 0.199), fill = "grey90", alpha = 0.3) +
#  geom_line(aes(col = st, group = st)) +
geom_line(col = "grey") +
geom_point(aes(col = s)) +
scale_color_gradient(high = "darkgreen", low = "orange") +
gg_xy(c(0, .61, 0, .41)) + geom_point(data = points_meas, aes(RtoPS2, FRtoPS2, col = CEF))
geom_point
points_meas
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>%
ggplot(aes(x = RtoPS2, y = FRtoPS2)) +
theme_bw() +
geom_rect(aes(xmin = 0.544, xmax = 0.556, ymin = 0, ymax = 0.41), fill = "pink", alpha = 0.3) +
geom_rect(aes(xmin = 0, xmax = 0.61, ymin = 0.181, ymax = 0.199), fill = "grey90", alpha = 0.3) +
#  geom_line(aes(col = st, group = st)) +
geom_line(col = "grey") +
geom_point(aes(col = s)) +
scale_color_gradient(high = "darkgreen", low = "orange") +
gg_xy(c(0, .61, 0, .41)) + geom_point(data = points_meas, aes(RtoPS2, FRtoPS2), col = "black")
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>%
ggplot(aes(x = RtoPS2, y = FRtoPS2)) +
theme_bw() +
geom_rect(aes(xmin = 0.544, xmax = 0.556, ymin = 0, ymax = 0.41), fill = "pink", alpha = 0.3) +
geom_rect(aes(xmin = 0, xmax = 0.61, ymin = 0.181, ymax = 0.199), fill = "grey90", alpha = 0.3) +
#  geom_line(aes(col = st, group = st)) +
geom_line(col = "grey") +
geom_point(aes(col = s)) +
scale_color_gradient(high = "darkgreen", low = "orange") +
gg_xy(c(0, .66, 0, .41)) + geom_point(data = points_meas, aes(RtoPS2, FRtoPS2), col = "black")
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>%
ggplot(aes(x = RtoPS2, y = FRtoPS2)) +
theme_bw() +
geom_rect(aes(xmin = 0.544, xmax = 0.556, ymin = 0, ymax = 0.41), fill = "pink", alpha = 0.3) +
geom_rect(aes(xmin = 0, xmax = 0.61, ymin = 0.181, ymax = 0.199), fill = "grey90", alpha = 0.3) +
#  geom_line(aes(col = st, group = st)) +
geom_line(col = "grey") +
geom_point(aes(col = s)) +
# scale_color_gradient(high = "darkgreen", low = "orange") +
gg_xy(c(0, .66, 0, .41)) + geom_point(data = points_meas, aes(RtoPS2, FRtoPS2, col = CEF))
ddd %>%
rbind_all2 %>%
mutate(s = Ratio)
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>% head
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>%
ggplot(aes(x = RtoPS2, y = FRtoPS2)) +
theme_bw() +
geom_rect(aes(xmin = 0.544, xmax = 0.556, ymin = 0, ymax = 0.41), fill = "pink", alpha = 0.3) +
geom_rect(aes(xmin = 0, xmax = 0.61, ymin = 0.181, ymax = 0.199), fill = "grey90", alpha = 0.3) +
#  geom_line(aes(col = st, group = st)) +
geom_line(col = "grey") +
geom_point(aes(col = s)) +
# scale_color_gradient(high = "darkgreen", low = "orange") +
gg_xy(c(0, .66, 0, .41)) + geom_point(data = points_meas, aes(RtoPS2, FRtoPS2, col = CEF)) +
scale_color_manual(values =  c("darkgreen", "orange"))
points_meas <-
data.frame(RtoPS2 = c(.55, .56, .57, .57, .50, .51, .51, .52, .60, .61, .62, .62, .54, .55, .55, .56),
FRtoPS2 = c(.18, .22, .24, .30, .16, .20, .22, .27, .23, .27, .29, .34, .20, .24, .26, .31),
Trtm = rep(c("W", "WFR"), 8),
CEF = rep(c(0, 1), each = 8),
Residual = rep(c("+", "-", "+", "-"), each = 4))
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>%
ggplot(aes(x = RtoPS2, y = FRtoPS2)) +
theme_bw() +
geom_rect(aes(xmin = 0.544, xmax = 0.556, ymin = 0, ymax = 0.41), fill = "pink", alpha = 0.3) +
geom_rect(aes(xmin = 0, xmax = 0.61, ymin = 0.181, ymax = 0.199), fill = "grey90", alpha = 0.3) +
#  geom_line(aes(col = st, group = st)) +
geom_line(col = "grey") +
geom_point(aes(col = s)) +
# scale_color_gradient(high = "darkgreen", low = "orange") +
gg_xy(c(0, .66, 0, .41)) + geom_point(data = points_meas, aes(RtoPS2, FRtoPS2, col = CEF)) +
scale_color_manual(values =  c("darkgreen", "orange"))
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>%
ggplot(aes(x = RtoPS2, y = FRtoPS2)) +
theme_bw() +
geom_rect(aes(xmin = 0.544, xmax = 0.556, ymin = 0, ymax = 0.41), fill = "pink", alpha = 0.3) +
geom_rect(aes(xmin = 0, xmax = 0.61, ymin = 0.181, ymax = 0.199), fill = "grey90", alpha = 0.3) +
#  geom_line(aes(col = st, group = st)) +
geom_line(col = "grey") +
# geom_point(aes(col = s)) +
# scale_color_gradient(high = "darkgreen", low = "orange") +
gg_xy(c(0, .66, 0, .41)) + geom_point(data = points_meas, aes(RtoPS2, FRtoPS2, col = CEF)) +
scale_color_manual(values =  c("darkgreen", "orange"))
points_meas <-
data.frame(RtoPS2 = c(.55, .56, .57, .57, .50, .51, .51, .52, .60, .61, .62, .62, .54, .55, .55, .56),
FRtoPS2 = c(.18, .22, .24, .30, .16, .20, .22, .27, .23, .27, .29, .34, .20, .24, .26, .31),
Trtm = rep(c("W", "WFR"), 8),
CEF = rep(c(0, 1), each = 8),
Residual = rep(c("+", "-", "+", "-"), each = 4))
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>%
ggplot(aes(x = RtoPS2, y = FRtoPS2)) +
theme_bw() +
geom_rect(aes(xmin = 0.544, xmax = 0.556, ymin = 0, ymax = 0.41), fill = "pink", alpha = 0.3) +
geom_rect(aes(xmin = 0, xmax = 0.61, ymin = 0.181, ymax = 0.199), fill = "grey90", alpha = 0.3) +
#  geom_line(aes(col = st, group = st)) +
geom_line(col = "grey") +
# geom_point(aes(col = s)) +
# scale_color_gradient(high = "darkgreen", low = "orange") +
gg_xy(c(0, .66, 0, .41)) + geom_point(data = points_meas, aes(RtoPS2, FRtoPS2, col = CEF)) +
scale_color_manual(values =  c("darkgreen", "orange"))
ddd %>%
head
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>%
head()
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>% str
```
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>%
ggplot(aes(x = RtoPS2, y = FRtoPS2)) +
theme_bw() +
# geom_rect(aes(xmin = 0.544, xmax = 0.556, ymin = 0, ymax = 0.41), fill = "pink", alpha = 0.3) +
# geom_rect(aes(xmin = 0, xmax = 0.61, ymin = 0.181, ymax = 0.199), fill = "grey90", alpha = 0.3) +
#  geom_line(aes(col = st, group = st)) +
geom_line(col = "grey") +
# geom_point(aes(col = s)) +
# scale_color_gradient(high = "darkgreen", low = "orange") +
gg_xy(c(0, .66, 0, .41)) + geom_point(data = points_meas, aes(RtoPS2, FRtoPS2, col = CEF)) +
scale_color_manual(values =  c("darkgreen", "orange"))
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>%
ggplot(aes(x = RtoPS2, y = FRtoPS2)) +
theme_bw() +
# geom_rect(aes(xmin = 0.544, xmax = 0.556, ymin = 0, ymax = 0.41), fill = "pink", alpha = 0.3) +
# geom_rect(aes(xmin = 0, xmax = 0.61, ymin = 0.181, ymax = 0.199), fill = "grey90", alpha = 0.3) +
# geom_line(aes(col = st, group = st)) +
# geom_line(col = "grey") +
# geom_point(aes(col = s)) +
# scale_color_gradient(high = "darkgreen", low = "orange") +
gg_xy(c(0, .66, 0, .41)) + geom_point(data = points_meas, aes(RtoPS2, FRtoPS2, col = CEF)) +
scale_color_manual(values =  c("darkgreen", "orange"))
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>%
ggplot(aes(x = RtoPS2, y = FRtoPS2)) +
theme_bw() +
# geom_rect(aes(xmin = 0.544, xmax = 0.556, ymin = 0, ymax = 0.41), fill = "pink", alpha = 0.3) +
# geom_rect(aes(xmin = 0, xmax = 0.61, ymin = 0.181, ymax = 0.199), fill = "grey90", alpha = 0.3) +
# geom_line(aes(col = st, group = st)) +
# geom_line(col = "grey") +
# geom_point(aes(col = s)) +
# scale_color_gradient(high = "darkgreen", low = "orange") +
gg_xy(c(0, .66, 0, .41)) + geom_point(data = points_meas, aes(x = RtoPS2, y = FRtoPS2, col = CEF)) +
scale_color_manual(values =  c("darkgreen", "orange"))
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>%
ggplot(aes(x = RtoPS2, y = FRtoPS2)) +
theme_bw() +
# geom_rect(aes(xmin = 0.544, xmax = 0.556, ymin = 0, ymax = 0.41), fill = "pink", alpha = 0.3) +
# geom_rect(aes(xmin = 0, xmax = 0.61, ymin = 0.181, ymax = 0.199), fill = "grey90", alpha = 0.3) +
# geom_line(aes(col = st, group = st)) +
# geom_line(col = "grey") +
# geom_point(aes(col = s)) +
# scale_color_gradient(high = "darkgreen", low = "orange") +
gg_xy(c(0, .66, 0, .41)) + geom_point(data = points_meas, aes(x = RtoPS2, y = FRtoPS2, col = CEF))
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>%
ggplot(aes(x = RtoPS2, y = FRtoPS2)) +
theme_bw() +
# geom_rect(aes(xmin = 0.544, xmax = 0.556, ymin = 0, ymax = 0.41), fill = "pink", alpha = 0.3) +
# geom_rect(aes(xmin = 0, xmax = 0.61, ymin = 0.181, ymax = 0.199), fill = "grey90", alpha = 0.3) +
# geom_line(aes(col = st, group = st)) +
geom_line(col = "grey") +
# geom_point(aes(col = s)) +
# scale_color_gradient(high = "darkgreen", low = "orange") +
gg_xy(c(0, .66, 0, .41)) + geom_point(data = points_meas, aes(x = RtoPS2, y = FRtoPS2, col = CEF)) +
scale_color_manual(values =  c("darkgreen", "orange"))
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>%
ggplot(aes(x = RtoPS2, y = FRtoPS2)) +
theme_bw() +
# geom_rect(aes(xmin = 0.544, xmax = 0.556, ymin = 0, ymax = 0.41), fill = "pink", alpha = 0.3) +
# geom_rect(aes(xmin = 0, xmax = 0.61, ymin = 0.181, ymax = 0.199), fill = "grey90", alpha = 0.3) +
# geom_line(aes(col = st, group = st)) +
geom_line(col = "grey") +
# geom_point(aes(col = s)) +
# scale_color_gradient(high = "darkgreen", low = "orange") +
gg_xy(c(0, .66, 0, .41)) + geom_point(data = points_meas, aes(x = RtoPS2, y = FRtoPS2, col = CEF))
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>%
ggplot(aes(x = RtoPS2, y = FRtoPS2)) +
theme_bw() +
# geom_rect(aes(xmin = 0.544, xmax = 0.556, ymin = 0, ymax = 0.41), fill = "pink", alpha = 0.3) +
# geom_rect(aes(xmin = 0, xmax = 0.61, ymin = 0.181, ymax = 0.199), fill = "grey90", alpha = 0.3) +
# geom_line(aes(col = st, group = st)) +
geom_line(col = "grey") +
# geom_point(aes(col = s)) +
# scale_color_gradient(high = "darkgreen", low = "orange") +
gg_xy(c(0, .66, 0, .41)) + geom_point(data = points_meas, aes(x = RtoPS2, y = FRtoPS2, col = CEF, shape = Residual))
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>%
ggplot(aes(x = RtoPS2, y = FRtoPS2)) +
theme_bw() +
# geom_rect(aes(xmin = 0.544, xmax = 0.556, ymin = 0, ymax = 0.41), fill = "pink", alpha = 0.3) +
# geom_rect(aes(xmin = 0, xmax = 0.61, ymin = 0.181, ymax = 0.199), fill = "grey90", alpha = 0.3) +
geom_line(col = "grey") +
geom_point(aes(col = s)) +
# scale_color_gradient(high = "darkgreen", low = "orange") +
gg_xy(c(0, .66, 0, .41)) + geom_point(data = points_meas, aes(x = RtoPS2, y = FRtoPS2, col = CEF, shape = Residual)) +
scale_color_manual(values =  c("darkgreen", "orange"))
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>%
ggplot(aes(x = RtoPS2, y = FRtoPS2)) +
theme_bw() +
# geom_rect(aes(xmin = 0.544, xmax = 0.556, ymin = 0, ymax = 0.41), fill = "pink", alpha = 0.3) +
# geom_rect(aes(xmin = 0, xmax = 0.61, ymin = 0.181, ymax = 0.199), fill = "grey90", alpha = 0.3) +
geom_line(col = "grey") +
# geom_point(aes(col = s)) +
# scale_color_gradient(high = "darkgreen", low = "orange") +
gg_xy(c(0, .66, 0, .41)) + geom_point(data = points_meas, aes(x = RtoPS2, y = FRtoPS2, col = CEF, shape = Residual)) +
scale_color_manual(values =  c("darkgreen", "orange"))
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>%
ggplot(aes(x = RtoPS2, y = FRtoPS2)) +
theme_bw() +
# geom_rect(aes(xmin = 0.544, xmax = 0.556, ymin = 0, ymax = 0.41), fill = "pink", alpha = 0.3) +
# geom_rect(aes(xmin = 0, xmax = 0.61, ymin = 0.181, ymax = 0.199), fill = "grey90", alpha = 0.3) +
# geom_line(aes(col = st, group = st)) +
geom_line(col = "grey") +
# geom_point(aes(col = s)) +
# scale_color_gradient(high = "darkgreen", low = "orange") +
gg_xy(c(0, .66, 0, .41)) + geom_point(data = points_meas, aes(x = RtoPS2, y = FRtoPS2, col = CEF, shape = Residual))
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>%
ggplot(aes(x = RtoPS2, y = FRtoPS2)) +
theme_bw() +
# geom_rect(aes(xmin = 0.544, xmax = 0.556, ymin = 0, ymax = 0.41), fill = "pink", alpha = 0.3) +
# geom_rect(aes(xmin = 0, xmax = 0.61, ymin = 0.181, ymax = 0.199), fill = "grey90", alpha = 0.3) +
# geom_line(aes(col = st, group = st)) +
geom_line(col = "grey") +
# geom_point(aes(col = s)) +
# scale_color_gradient(high = "darkgreen", low = "orange") +
gg_xy(c(0, .66, 0, .41)) + geom_point(data = points_meas, aes(x = RtoPS2, y = FRtoPS2, col = CEF, shape = Residual, fill = Trtm))
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>%
ggplot(aes(x = RtoPS2, y = FRtoPS2)) +
theme_bw() +
# geom_rect(aes(xmin = 0.544, xmax = 0.556, ymin = 0, ymax = 0.41), fill = "pink", alpha = 0.3) +
# geom_rect(aes(xmin = 0, xmax = 0.61, ymin = 0.181, ymax = 0.199), fill = "grey90", alpha = 0.3) +
# geom_line(aes(col = st, group = st)) +
geom_line(col = "grey") +
# geom_point(aes(col = s)) +
# scale_color_gradient(high = "darkgreen", low = "orange") +
gg_xy(c(0, .66, 0, .41)) + geom_point(data = points_meas, aes(x = RtoPS2, y = FRtoPS2, col = paste0(CEF, Residual), shape = Trtm))
data.frame(RtoPS2 = c(.55, .56, .57, .57, .50, .51, .51, .52, .60, .61, .62, .62, .54, .55, .55, .56),
FRtoPS2 = c(.18, .22, .24, .30, .16, .20, .22, .27, .23, .27, .29, .34, .20, .24, .26, .31),
Trtm = rep(c("W", "WFR"), 8),
CEF = rep(c(0, 1), each = 8),
State = rep(c("R", "R+FR", "R", "R+FR", "R", "R+FR", "R", "R+FR"), 2),
Residual = rep(c("+", "-", "+", "-"), each = 4))
data.frame(RtoPS2 = c(.55, .56, .57, .57, .50, .51, .51, .52, .60, .61, .62, .62, .54, .55, .55, .56),
FRtoPS2 = c(.18, .22, .24, .30, .16, .20, .22, .27, .23, .27, .29, .34, .20, .24, .26, .31),
Trtm = rep(c("W", "WFR"), 8),
CEF = rep(c(0, 1), each = 8),
State = rep(c("R", "R", "R+FR", "R+FR"), 4),
Residual = rep(c("+", "-", "+", "-"), each = 4))
points_meas <-
data.frame(RtoPS2 = c(.55, .56, .57, .57, .50, .51, .51, .52, .60, .61, .62, .62, .54, .55, .55, .56),
FRtoPS2 = c(.18, .22, .24, .30, .16, .20, .22, .27, .23, .27, .29, .34, .20, .24, .26, .31),
Trtm = rep(c("W", "WFR"), 8),
CEF = rep(c(0, 1), each = 8),
State = rep(c("R", "R", "R+FR", "R+FR"), 4),
Residual = rep(c("+", "-", "+", "-"), each = 4))
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>%
ggplot(aes(x = RtoPS2, y = FRtoPS2)) +
theme_bw() +
# geom_rect(aes(xmin = 0.544, xmax = 0.556, ymin = 0, ymax = 0.41), fill = "pink", alpha = 0.3) +
# geom_rect(aes(xmin = 0, xmax = 0.61, ymin = 0.181, ymax = 0.199), fill = "grey90", alpha = 0.3) +
# geom_line(aes(col = st, group = st)) +
geom_line(col = "grey") +
# geom_point(aes(col = s)) +
# scale_color_gradient(high = "darkgreen", low = "orange") +
gg_xy(c(0, .66, 0, .41)) + geom_point(data = points_meas, aes(x = RtoPS2, y = FRtoPS2, col = paste0(CEF, Residual, State), shape = Trtm))
data.frame(RtoPS2 = c(.55, .56, .57, .57, .50, .51, .51, .52, .60, .61, .62, .62, .54, .55, .55, .56),
FRtoPS2 = c(.18, .22, .24, .30, .16, .20, .22, .27, .23, .27, .29, .34, .20, .24, .26, .31),
Trtm = rep(c("W", "WFR"), 8),
CEF = rep(c("CEF-", "CEF+"), each = 8),
State = rep(c("R", "R", "R+FR", "R+FR"), times = 4)
```)
data.frame(RtoPS2 = c(.55, .56, .57, .57, .50, .51, .51, .52, .60, .61, .62, .62, .54, .55, .55, .56),
FRtoPS2 = c(.18, .22, .24, .30, .16, .20, .22, .27, .23, .27, .29, .34, .20, .24, .26, .31),
Trtm = rep(c("W", "WFR"), 8),
CEF = rep(c("CEF-", "CEF+"), each = 8),
State = rep(c("R", "R", "R+FR", "R+FR"), times = 4))
rep(c("NPP-", "NPP+", "NPP-", "NPP+"), each = 4)
points_meas <-
data.frame(RtoPS2 = c(.55, .56, .57, .57, .50, .51, .51, .52, .60, .61, .62, .62, .54, .55, .55, .56),
FRtoPS2 = c(.18, .22, .24, .30, .16, .20, .22, .27, .23, .27, .29, .34, .20, .24, .26, .31),
Trtm = rep(c("W", "WFR"), 8),
CEF = rep(c("CEF-", "CEF+"), each = 8),
State = rep(c("R", "R", "R+FR", "R+FR"), times = 4),
Residual = rep(c("NPP-", "NPP+", "NPP-", "NPP+"), each = 4))
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>%
ggplot(aes(x = RtoPS2, y = FRtoPS2)) +
theme_bw() +
# geom_rect(aes(xmin = 0.544, xmax = 0.556, ymin = 0, ymax = 0.41), fill = "pink", alpha = 0.3) +
# geom_rect(aes(xmin = 0, xmax = 0.61, ymin = 0.181, ymax = 0.199), fill = "grey90", alpha = 0.3) +
# geom_line(aes(col = st, group = st)) +
geom_line(col = "grey") +
# geom_point(aes(col = s)) +
# scale_color_gradient(high = "darkgreen", low = "orange") +
gg_xy(c(0, .66, 0, .41)) + geom_point(data = points_meas, aes(x = RtoPS2, y = FRtoPS2, col = paste0(CEF, Residual, State), shape = Trtm))
ddd %>%
rbind_all2 %>%
mutate(s = Ratio) %>%
ggplot(aes(x = RtoPS2, y = FRtoPS2)) +
theme_bw() +
# geom_rect(aes(xmin = 0.544, xmax = 0.556, ymin = 0, ymax = 0.41), fill = "pink", alpha = 0.3) +
# geom_rect(aes(xmin = 0, xmax = 0.61, ymin = 0.181, ymax = 0.199), fill = "grey90", alpha = 0.3) +
# geom_line(aes(col = st, group = st)) +
geom_line(col = "grey") +
# geom_point(aes(col = s)) +
# scale_color_gradient(high = "darkgreen", low = "orange") +
gg_xy(c(0.39, .66, 0, .41)) + geom_point(data = points_meas, aes(x = RtoPS2, y = FRtoPS2, col = paste0(CEF, Residual, State), shape = Trtm))
Optics %>%
select(-k) %>%
SPD + ylab("absorptance/reflectance/transmittance") + gg_y(c(0,1))
